name: Validate SuperStrict
on: [workflow_dispatch, workflow_call]

jobs:
  bash-script:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
        with:
          repository: '2dengine/sstrict.lua'
          path: 'sstrict.lua'
          ref: 'main'
        
      - name: Lua 5.1 Test
        run: |
          sudo apt -y install lua5.1
          sudo apt -y install lua-filesystem
          sudo apt update
          if [ -f "2dengine/.github/workflows/scan.lua" ]; then
            cat "2dengine/.github/workflows/scan.lua" > "./scan.lua"
          fi
          lua "./scan.lua"
          if test -f "./test.lua"; then
            lua "./test.lua"
          fi
        
      - name: Lua 5.2 Test
        run: |
          sudo apt -y install lua5.2
          sudo apt -y install lua-filesystem
          sudo apt update
          lua "./.github/workflows/scan.lua"
          if test -f "./test.lua"; then
            lua "./test.lua"
          fi

      - name: Lua 5.3 Test
        run: |
          sudo apt -y install lua5.3
          sudo apt -y install lua-filesystem
          sudo apt update
          lua "./.github/workflows/scan.lua"
          if test -f "./test.lua"; then
            lua "./test.lua"
          fi

